---
layout: page
title: Buddy
---

# サブキャラ
{: .no_toc }

`サブキャラ` はVMagicMirror v4.0.0で追加された機能です。

この機能では通常表示している3Dモデルのアバターとは別のキャラクターを表示できます。

以下ではサブキャラとの区別がしやすいように、通常表示する3Dモデルのアバターを `メインアバター` と呼んでいます。

<div class="row">
{% include docimg.html file="/images/docs/buddy_top.png" customclass="col s12 m6 l6" imgclass="fit-doc-img" %}
</div>

<div class="toc-area" markdown="1">

#### 目次
{: .toc-header .no_toc }

* ToC
{:toc .table-of-contents }

</div>


#### サブキャラ機能の特徴
{: .doc-sec2 }

サブキャラ機能のおもな特徴は以下の通りです。

<div class="doc-ul" markdown="1">

- 透過画像(`.png`)として制作したサブキャラを表示して、アバターウィンドウの最前面、またはメインアバターと同じ3D空間上に配置できます。
- 動作はユーザー定義の `C#` スクリプトで記述します。
- とくに、メインアバターの仕草やユーザー入力をイベントとしたリアクションが作成できます。

</div>

<div class="note-area" markdown="1">

**NOTE**

v4.0.0の時点では未対応ですが、今後のアップデートで3Dデータ(VRM, glb)の表示サポートを予定しています。

</div>


#### 機能制限について
{: .doc-sec2 }

無償で配布している基本エディションでは、サブキャラがメインアバターやユーザー動作に反応するための機能である `インタラクションAPI` をオンにすると専用のエフェクトが適用されます。
この機能をオフにしていてもサブキャラは起動できますが、サブキャラの動作が制限されます。以下は制限される動作の例です。

<div class="doc-ul" markdown="1">

- アバターのまばたきや表情を真似るような挙動
- ユーザーのマイク入力の区切りに反応できるような挙動
- ユーザーのキーボード/ゲームパッド入力に反応するような挙動

</div>

上記の制限を外して利用するにはフルエディションをお求め下さい。フルエディションの詳細は[ダウンロード](../../download)のページで詳しく紹介しています。


#### サブキャラを使用する
{: .doc-sec2 }

サブキャラを使用するには、`サブキャラ` タブで起動したいサブキャラのチェックをオンにします。
v4.0.0以降でインストール時から表示されているサブキャラは、アプリケーションにデフォルトとして組み込まれているサブキャラです。

サブキャラの配置は `フリーレイアウト` をオンにして編集できます。
ただし、最前面に表示したサブキャラの位置が画面端や画面外になっている場合、フリーレイアウト機能では配置を変更できないことがあります。

この場合はサブキャラの詳細設定を開き、サブキャラの位置の(`x` や `y` の値)を直接編集します。

画像ベースで最前面に表示されるサブキャラの位置は、アバターウィンドウのサイズをおおよそ `1280 x 720` としたときの座標で指定します。画面の左下が `(x, y) = (0, 0)`として扱われます。

サブキャラ全般に対して適用できる設定や機能は以下の通りです。

<div class="doc-ul" markdown="1">

- `インタラクションAPIを使用`: オンにすることで、サブキャラがメインアバターの動作やユーザー入力に反応できるようになります。このチェックはフルエディションでは既定でオン、基本エディションではオフになっています。
- `フォルダを開く`: 後述の `配布されているサブキャラを使用する` を行うときの配置先となるフォルダを開きます。
- `全て再読み込み`: 全てのサブキャラを再読み込みします。VMagicMirrorの実行中に `配布されているサブキャラを使用する` の操作を行った場合、その結果を適用するときに使用します。
- `開発者モード`: サブキャラの自作時にオンにします。詳細は [開発者向けドキュメントのページ](https://malaybaku.github.io/VMagicMirrorBuddyDoc/) を参照して下さい。

</div>

そのほかの設定は基本的にはサブキャラごとに固有に定義された設定項目です。それぞれのサブキャラの説明がある場合はそれを適宜確認してください。


#### 配布されているサブキャラを使用する
{: .doc-sec2 }

サブキャラがzipファイル等で配布されている場合、以下の手順で使用できます。

<div class="doc-ul" markdown="1">

- zipなどの圧縮ファイルの解凍前に、ファイルのプロパティを確認し、セキュリティのチェックを解除します。
- zipファイルを解凍します。
- ファイルエクスプローラで `(マイドキュメント)\VMagicMirror_Files\Buddy\` フォルダを開きます。
- 後述するフォルダ構造になるように、解凍したフォルダを配置します。

</div>

フォルダを配置するときは、フォルダ構造が以下の形になるようにします。とくに、zipファイルの解凍時にフォルダが二重になっている場合は二重のフォルダをそのまま配置しないように注意してください。

<div class="doc-ul" markdown="1">

- `(マイドキュメント)\VMagicMirror_Files\Buddy\{フォルダ}\`
  - `main.csx`
  - `manifest.json`
  - ...

</div>

<div class="row">
{% include docimg.html file="/images/docs/buddy_folder_structure.png" customclass="col s12 m6 l6" imgclass="fit-doc-img" %}
</div>


また、サブキャラを導入した後はサブキャラのフォルダ名はそのままにするようにしてください。フォルダ名を変更した場合、そのサブキャラの設定はリセットされます。


#### サブキャラを自作・配布する
{: .doc-sec2 }

サブキャラの自作や配布を検討している場合、VMagicMirrorのサブキャラ開発に関するドキュメントページを参照して下さい。

[ドキュメントのページ](https://malaybaku.github.io/VMagicMirrorBuddyDoc/)

上記のページではほぼ空のサブキャラのテンプレートやスクリプトAPIの一覧などを紹介しています。

<div class="note-area" markdown="1">

**NOTE**

v4.0.0の公開時点で、サブキャラのスクリプトを自作するには高度なプログラミングの知識や調査が必要になる想定です。

スクリプトの自作を必要としない高度なテンプレートの追加については、本ページ、上記のドキュメントのページ、BOOTH等での配布を予定しています。

</div>


#### 画像を差し替えて利用可能なサブキャラのテンプレートについて
{: .doc-sec2 }

サブキャラがテンプレートの形式で配布されている場合、スクリプト等はとくに編集せず、画像ファイルを準備するだけでサブキャラをセットアップすることもできます。

下記のテンプレートを用いると、VMagicMirror v4.0.0のデフォルトのサブキャラとほぼ同じ仕草になるようなサブキャラが制作できます。

[VMMサブキャラ_画像入れ替え用テンプレート](https://baku-dreameater.booth.pm/items/6998661)

